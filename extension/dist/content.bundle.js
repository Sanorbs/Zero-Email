var ZEMSContentScript,__webpack_exports__={};function extractCurrentEmail(){try{const e=document.querySelector("[data-legacy-thread-id]");return e?{id:e.dataset.legacyThreadId,from:document.querySelector("[email]")?.textContent.trim()||document.querySelector(".gD")?.textContent.trim()||"Unknown",subject:document.querySelector("h2[data-thread-perm-id]")?.textContent.trim()||document.querySelector("h2")?.textContent.trim()||"No Subject",body:document.querySelector(".ii.gt")?.textContent.trim()||document.querySelector(".a3s.aiL")?.textContent.trim()||"",date:document.querySelector(".g3")?.title||document.querySelector(".xW.xY")?.textContent.trim()||(new Date).toISOString(),metadata:{read:!document.querySelector('[aria-label="Mark as unread"]'),starred:!!document.querySelector('[aria-label="Remove star"]')}}:null}catch(e){return console.error("ZEMS: Email extraction error",e),null}}function isExtensionContextValid(){try{return!!chrome.runtime?.id}catch(e){return!1}}function safeSendMessage(e,t){if(!isExtensionContextValid())return console.warn("ZEMS: Context invalid - reloading"),void window.location.reload();try{chrome.runtime.sendMessage(e,(e=>{chrome.runtime.lastError?console.error("ZEMS: Message failed",chrome.runtime.lastError):t?.(e)}))}catch(e){console.error("ZEMS: Message sending failed",e)}}function processEmail(){if(!isExtensionContextValid())return;const e=extractCurrentEmail();e&&(console.log("ZEMS: Extracted email",e),safeSendMessage({type:"PROCESS_EMAIL",email:e},(e=>{e?.success&&console.log("ZEMS: Email processed successfully")})))}function initializeObserver(){const e=new MutationObserver((()=>{isExtensionContextValid()&&processEmail()}));try{e.observe(document.body,{subtree:!0,childList:!0,attributes:!0,characterData:!0}),console.log("ZEMS: Content script initialized")}catch(e){console.error("ZEMS: Observer failed to start",e)}}isExtensionContextValid()&&("complete"===document.readyState?initializeObserver():window.addEventListener("load",initializeObserver)),ZEMSContentScript=__webpack_exports__;